{% extends "thoughts/base.html" %}

{% block title %}Add your Though{% endblock title %}

{% block additional_css %}
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/sweetalert2/6.3.2/sweetalert2.min.css">
{% endblock additional_css %}

{% block main %}
  
  <div class="thought-update-page">
    {% if object %}
      <h2>Edit your thought</h2>
    {% else %}
      <h2>Add new thought</h2>
    {% endif %}
    <div class="wrapper">
      <form action="." method="post">
        {% include "thoughts/form_template.html" %}
        <button type="submit" class="btn btn-success btn-lg">
          {% if object %}
            Save
          {% else %}
            Add
          {% endif %}
        </button>
      </form>
      {% if object %}
          <form id="thought-delete-form" action="{% url "thoughts:thought-delete" object.id %}" method="post">
            {% csrf_token %}
            <button type="submit" class="btn btn-danger btn-lg thought-delete-button">Delete</button>
          </form>
      {% endif %}
    </div>
  </div>
{% endblock main %}

{% block javascript %}
  <script src="https://cdn.jsdelivr.net/sweetalert2/6.3.2/sweetalert2.min.js"></script>
  <script>
    var $form = $('#thought-delete-form');
    $('.thought-delete-button').on('click', function(e) {
      e.preventDefault();
      swal({
        title: 'Are you sure?',
        text: "You won't be able to revert this!",
        type: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#3085d6',
        cancelButtonColor: '#d33',
        confirmButtonText: 'Yes, delete it!'
      }).then(function () {
        swal(
          'Deleted!',
          'Your thought has been deleted.',
          'success'
        ).then(function(){
          $form.submit();
        })
      })
    });
  </script>
  
{% endblock javascript %}